Content delivery network
==========================================================
内容分发网络(CDN, Content delivery network)指一种通过互联网互相连接的电脑网络系统，利用最靠近每位用户的服务器，更快、更可靠地将音乐、图片、视频、应用程序及其他文件(尤其是静态内容)发送给用户，来提供高性能、可扩展性及低成本的网络内容传递给用户。

简单来说，CDN做了两件事情：

- 你的内容离用户更近，这意味着更快的访问速度
- 节约了你服务器的算力，让它可以处理其他事情

一般来说，诸如HTML/CSS/JS、视频、音频之类的静态文件都是通过CDN提供的，尽管有些CDN(例如Amazon的CloudFront)支持动态内容。当地的DNS会告诉客户端去访问哪个服务器。

推送式CDN(Push CDN)
-------------------------------------------
由你主动将内容上传到CDN上，用户在任何时候都能从CDN上获得该内容，从而在任何时候获得性能提升。比如，你用CDN供应商提供的工具/API，将内容上传到指定的空间，然后用工具刷新某个url路径(例如cdn.example.com/foobar.png)，CDN就会把你上传的新内容分发给他们各地的服务器。如果CDN供应商允许，你还可以设置内容何时过期，什么时候更新。

推送式CDN需要的存储空间比抓取式要大。而且你需要自己在内容变化时，将新内容上传并“刷新”。

推送式CDN适用于：内容不怎么变化，或者需要在任何时候都能获得加速的网站，或者短时间内有大量流量的网站(比如双11的淘宝)。

抓取式CDN(Pull CDN)
-------------------------------------------
当第一个用户访问某内容时，抓取式CDN从你的服务器上抓取并缓存起来，下一次访问该内容时就能直接从CDN获取。这意味着你必须在你的服务器上保存这些内容，以便CDN抓取。而且在CDN完成缓存之前，访问并不能得到加速(甚至更慢)。

TTL(time to live)决定内容被缓存多久。抓取式CDN最小化了CDN上需要的存储空间(只有部分网站内容被CDN缓存)，但是可能会导致冗余的流量：例如CDN上的文件过期，需要重新从你的服务器上抓取，但这些文件并没有变化过。

对于短时间内有大量流量的网站来说，抓取式CDN有可能引发严重问题。由于抓取需要一定时间，在抓取完成之前，用户的访问不会被加速，CDN没有起到效果。对于高访问量低下载量的网站来说，抓取式CDN可帮助网站将最热门的内容留在CDN上。

CDN的缺点
-------------------------------------------
- 根据流量的大小，CDN的花费可能会很大(不过如果不使用CDN，你的花费可能会更大)。
- 若内容在TTL到期之前更新，用户获取的内容可能是陈旧的
- CDN需要更改url，将静态内容指向CDN
